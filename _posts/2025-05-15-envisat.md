---
title: "ğŸ›°ï¸ EnviSAT-ASAR æ—¶é—´åºåˆ— InSAR æ•°æ®å¤„ç†å®Œæ•´æµç¨‹ (åŸºäºDoirs + StaMPS)"
date: 2025-05-15 10:00:00 +0800
categories: [InSAR, æ•°æ®å¤„ç†]
tags: [EnviSAT, StaMPS, Doris]
pin: false
toc: true
comments: true

---


> ğŸ¯ æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Doris + StaMPS è½¯ä»¶å¯¹ EnviSAT-ASAR æ•°æ®è¿›è¡Œæ—¶åº InSAR å¤„ç†ï¼ŒåŒ…æ‹¬æ•°æ®å‡†å¤‡ã€é¢„å¤„ç†ã€é…å‡†ã€å¹²æ¶‰å›¾ç”Ÿæˆã€ç›¸ä½è§£ç¼ ã€æœ€ç»ˆæ—¶åºåˆ†æç­‰æ­¥éª¤ã€‚å¤„ç†æ­¥éª¤å‚è€ƒ[StaMPSæ“ä½œè¯´æ˜ä¹¦](https://homepages.see.leeds.ac.uk/~earahoo/stamps/StaMPS_Manual_v4.1b1.pdf)ã€‚<br>
> ğŸ¤” æ–‡ä¸­æ²¡æœ‰æä¾›çš„è„šæœ¬ï¼Œé»˜è®¤ä½¿ç”¨Doris + StaMPS å®˜æ–¹è„šæœ¬ï¼Œå¯ç›´æ¥è°ƒç”¨ã€‚

---
## ğŸ§­ å¤„ç†æµç¨‹æ¦‚è§ˆ

1. ğŸ“ æ•°æ®å‡†å¤‡  
2. ğŸ“š æ•°æ®è¯»å–ä¸è£å‰ª   
3. ğŸ—ºï¸ DEMæ•°æ®  
4. ğŸŒŠ æ‰¹é‡å¤„ç†  
5. ğŸŒˆ Small Baseline å¤„ç†
6. ğŸ› ï¸ StaMPS æ—¶é—´åºåˆ—è§£ç®—
7. ğŸ“ˆ å½¢å˜æ—¶é—´åºåˆ—æå– 


---
## 1. ğŸ“ æ•°æ®å‡†å¤‡

- å‚è€ƒä¹‹å‰çš„å†…å®¹[æ•°æ®ä¸‹è½½](/posts/2025-05-08-data-preparation/)ï¼Œå°†æ¯ä¸ªFrameçš„æ•°æ®ä¸‹è½½åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ•°æ®æ ¼å¼å†…å®¹å¦‚ä¸‹ç¤ºä¾‹ï¼š

    `ASA_IMS_1PNESA20040104_024344_000000152023_00075_09648_0000.N1`
    `ASA_IMS_1PNESA20040523_024344_000000152027_00075_11652_0000.N1`
    `ASA_IMS_1PNESA20041010_024345_000000152031_00075_13656_0000.N1`
    `ASA_IMS_1PNESA20041114_024343_000000152032_00075_14157_0000.N1`
    `ASA_IMS_1PNESA20050123_024341_000000152034_00075_15159_0000.N1`

    - å°†æ¯ä¸€æœŸçš„æ•°æ®æ”¾ç½®åœ¨å•ç‹¬çš„æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹ç”¨æ—¥æœŸå‘½åï¼š

        [mkdir.csh](/code/mkdir.csh)

        ```bash
        mkdir.csh
        ```


- è½¨é“æ•°æ®ï¼Œå»ºè®®åœ¨[GMTSARå®˜ç½‘](https://topex.ucsd.edu/gmtsar/downloads/), ä¸‹è½½`Orbit Data`ï¼Œè§£å‹å­˜æ”¾åœ¨`/user/local/orbits`ç›®å½•ã€‚æˆ–ç›´æ¥è¿è¡Œä»¥ä¸‹ä»£ç ä¸‹è½½ï¼š

    ```bash
    http://topex.ucsd.edu/gmtsar/tar/ORBITS.tar
    sudo -i
    cd /usr/local
    mkdir orbits
    cd orbits
    tar -xvf ~/Downloads/ORBITS.tar # (need full path to ORBITS.tar)
    ```

    ä¿®æ”¹StaMPSå®‰è£…ç›®å½•ä¸­çš„`StaMPS_CONFIG.bash`æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹è·¯å¾„é…ç½®ï¼š
    
    ```
    export SAR_ODR_DIR="/user/local/orbits"
    ```


---
## 2. ğŸ“š æ•°æ®è¯»å–ä¸è£å‰ª 

-  âš™ï¸ åœ¨æ•°æ®å¤„ç†ç›®å½•ï¼Œé¦–å…ˆé“¾æ¥æ•°æ®ï¼Œè¿è¡Œè„šæœ¬

    ```bash
    link_slcs data_path 
    ```

     > æ¯ä¸ªæ—¥æœŸä¸‹ï¼Œéƒ½å­˜æ”¾ä¸‰ä¸ªæ–‡ä»¶
    
    æ•°æ®é“¾æ¥ `ASA_IMS_1PNESA20040104_024344_000000152023_00075_09648_0000.N1`<br>
    `image.slc` å’Œ `image.slc.rsc`




- é€‰æ‹©ä¸€ä¸ªæ—¥æœŸï¼Œä½œä¸ºè¶…çº§ä¸»å½±åƒï¼Œä½¿å‰©ä½™å½±åƒå‡ä¸å…¶é…å‡†ã€‚
           
    ```bash
    cd master_data
    step_read_whole_XXX
    ```

    > XXX ä»£è¡¨å«æ˜Ÿ â€˜ERSâ€™, â€˜Envisatâ€™, â€˜RSATâ€™, â€˜RSAT2â€™, â€˜TSXâ€™, or â€˜CSKâ€™; è¿™é‡Œé€‰æ‹©Envisatã€‚

    å®Œååï¼Œå¯æ‰“å¼€KMLæ–‡ä»¶æŸ¥çœ‹æ•°æ®èŒƒå›´ã€‚åŒæ—¶`SLC`ç›®å½•ä¼šç”Ÿæˆå‡ ä¸ªæ–‡ä»¶ã€‚

- ç¼–è¾‘`SLC`ç›®å½•çš„`master_crop_geo.in`æ–‡ä»¶ã€‚`lon lat`ä»£è¡¨å½±åƒä¸­å¿ƒçš„ç»çº¬åº¦ï¼Œ`n_lines n_pixels`ä»£è¡¨è·ç¦»å‘å’Œæ–¹ä½å‘çš„è¡Œæ•°ï¼Œä¸€èˆ¬å–30000å’Œ5000ã€‚

    `lon        113.5`<br>
    `lat        42.33`<br>
    `n_lines    30000`<br>
    `n_pixels   5000`<br>
    ç¼–è¾‘å®Œæˆåï¼Œåœ¨`master_date`ç›®å½•ä¸‹è¿è¡Œä»¥ä¸‹ä»£ç ï¼Œä½¿å‰©ä½™æ‰€æœ‰å½±åƒå‡è£å‰ªè‡³ä¸ä¸»å½±åƒä¸€è‡´ã€‚

    ```bash
    step_master_read_geo
    cd ..
    make_read_geo
    ```

---
## 3. ğŸ—ºï¸ DEMæ•°æ® 

- åœ¨`SLC`ä¸`INSAR_master_date`åŒçº§ç›®å½•ä¸‹å»ºç«‹`DEM`æ–‡ä»¶å¤¹ï¼Œå°†`DEM.flt`æ”¾ç½®äºæ­¤ï¼Œæ ¼å¼è½¬æ¢å¦‚ä¸‹ï¼š

    `gdal_translate -of ENVI DEM.grd DEM.flt `

- è¿›å…¥`INSAR_master_date`æ–‡ä»¶å¤¹ï¼Œè¿è¡Œä»¥ä¸‹ä»£ç ã€‚

    ```bash
    step_master_orbit_ODR
    ```

    ç„¶åï¼ŒåŸºäº`DEM.flt`ä¿¡æ¯ï¼Œç¼–è¾‘`timing.dorisin`æ–‡ä»¶ä»¥ä¸‹å†…å®¹ã€‚

    `SAM_IN_FORMAT   real4`<br>
    `SAM_IN_DEM      /data/T156/DEM/DEM.flt   //DEMè·¯å¾„` <br>
    `SAM_IN_SIZE     5222 6070               // rows cols`<br>
    `SAM_IN_DELTA    0.000092592574951594    // åˆ†è¾¨ç‡`<br>    
    `SAM_IN_UL       46.42181 -122.46252     // å·¦ä¸Šè§’çš„ç»´åº¦ã€ç»åº¦`<br>
    `SAM_IN_NODATA   -9999`<br>

    å®Œæˆåï¼Œè¿è¡Œè„šæœ¬ï¼š

    ```bash
    step_master_timing
    ```

    ğŸŒŸğŸŒŸğŸŒŸ è¿™ä¸€æ­¥è¿è¡Œæ—¶é—´å¯èƒ½è¾ƒé•¿ï¼Œå¯ä»¥åŒæ—¶å’Œ`make_orbits`ï¼ˆå¾ˆå¿«å®Œæˆï¼‰ã€`make_coarse`ï¼ˆç”¨æ—¶è¾ƒä¹…ï¼‰å’Œ`make_coreg`ï¼ˆç”¨æ—¶è¾ƒä¹…ï¼‰è¿è¡Œã€‚

    ```bash
    make_orbits
    make_coarse
    make_coreg
    ```
    
    > ä¸€ä¸ªå‘½ä»¤ä¸€ä¸ªç»ˆç«¯ï¼ŒåŒæ—¶å¤„ç†ã€‚

---
## 4. ğŸ—ºï¸ æ‰¹é‡å¤„ç†

- ä»¥ä¸‹ä»£ç ï¼ŒæŒ‰é¡ºåºä¾æ¬¡è¿›è¡Œï¼Œåšå®Œä¸€ä¸ªå†åšä¸‹ä¸€ä¸ªã€‚

    ```bash
    make_dems
    make_resample
    make_ifgs
    ```

    è¿›å…¥ä»»æ„ä¸€ä¸ªè¾…å½±åƒæ–‡ä»¶å¤¹ï¼Œè¿è¡Œè„šæœ¬

    ```bash
    step_geo
    ```

---
## 5. ğŸŒˆ Small Baseline å¤„ç†

- é¦–å…ˆæå–å½±åƒåŸºçº¿ä¿¡æ¯

    ```bash
    mt_extract_info
    ```

- æ‰“å¼€matlabï¼Œè¿è¡Œä»£ç ï¼Œç”Ÿæˆ`small_baselines.list`ã€‚

    ```matlab
    ps_load_info
    sb_find(rho_min,Ddiff_max,Bdiff_max) %é»˜è®¤0.5ï¼Œ1500ï¼Œ1070
    plot_sb_baselines
    ```
    > ä¸€èˆ¬éœ€è¦ä¸æ–­è°ƒè¯•Ddiff_max,Bdiff_maxã€‚ä½¿åŸºçº¿ç»„åˆåŒ€ç§°åˆç†ã€‚

- æŒ‰ç…§ç”Ÿæˆçš„å¹²æ¶‰ç»„åˆè¿›è¡Œå·®åˆ†å¹²æ¶‰ï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œå‘½ä»¤

    ```bash
    make_small_baselines
    ```

- åœ¨`SMALL_BASELINES`ç›®å½•ä¸­ï¼Œè¿è¡Œä»¥ä¸‹ä»£ç åˆ†å—

    ```bash
    mt_prep 0.6 3 2 50 200
    ```

    `0.6 = amplitude difference dispersion (0.6 is reasonable)`<br>
    `3 = number of patches in range (default 1) `<br>
    `2 = number of patches in azimuth, (default 1) `<br>
    `50 = overlapping pixels between patches in range (default 50) `<br>
    `200 = overlapping pixels between patches in azimuth (default 200) `<br>

---
## 6. ğŸ› ï¸ StaMPS æ—¶é—´åºåˆ—è§£ç®—

- è®¾ç½®å‚æ•°`weed_standard_dev`(æ ‡å‡†å·®ç­›é€‰é˜ˆå€¼), æ¨èé€‰æ‹©2.0ã€‚å¹¶è¡Œå¤„ç†`n_cores`ï¼Œé€‰æ‹©10ã€‚

    ```matlab
    setparm('weed_standard_dev',2.0)
    setparm('n_cores',10)
    ```

- å‚æ•°è®¾ç½®å®Œæˆåï¼Œå³å¯è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¼€å§‹è§£ç®—SBAS

    ```matlab
    stamps
    ```
    
---
## 7. ğŸ“ˆ å½¢å˜æ—¶é—´åºåˆ—æå– 

> æ—¶é—´åºåˆ—åˆ†ææ˜¯InSARçš„å…³é”®ç¯èŠ‚ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä»‹ç»å¦‚ä½•æå–StaMPSç»“æœä¸­ä¸€äº›ç‚¹ä½çš„æ—¶é—´åºåˆ—ã€‚

- æŸ¥çœ‹æ—¶é—´åºåˆ—ï¼Œåœ¨matlabä¸­è¿è¡Œå‘½ä»¤

    ```matlab
    ps_plot('V-do','ts')
    ```

    - å¯ä»¥ç‚¹å‡»`TS plot`æŒ‰é’®ï¼Œåœ¨åœ°å›¾ä¸­é€‰ç‚¹ï¼Œç»˜åˆ¶æ—¶é—´åºåˆ—
    - æˆ–è€…ï¼Œåœ¨StaMPSå®‰è£…ç›®å½•ä¸­ï¼Œæ‰¾åˆ°`/StaMPS-4.1-beta/matlab/ts_plot.m`æ–‡ä»¶ï¼Œåœ¨44è¡Œä¹‹åé‡æ–°è®¾ç½®ç‚¹çš„ç»çº¬åº¦ï¼š

    ```matlab
    [lon0,lat0] = ginput(1); % turn on when final
    lon0 = 112.15575;   %æ—¶åºç‚¹çš„ç»åº¦
    lat0 = 37.53895;    %æ—¶åºç‚¹çš„ç»´åº¦
    ```
   
- StaMPSä¸­èƒ½å¤Ÿç»˜åˆ¶ç‚¹çš„æ—¶é—´åºåˆ—ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¯å°†æ—¶é—´åºåˆ—å¯¼å‡º

    ```matlab
    ts_table = [day(:), ts(:)];
    ts_table_double = double(ts_table);  % è½¬æˆ double
    save('output.txt', 'ts_table_double', '-ascii');
    ```





    
 










    
    
