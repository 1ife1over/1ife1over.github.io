---
title: "æ—¶é—´åºåˆ—å­£èŠ‚æ€§å½¢å˜æ‹Ÿåˆï¼ˆåŸºäºMatlabï¼‰"
date: 2025-06-03 09:14:00 +0800
categories: [InSAR, æ—¶é—´åºåˆ—åˆ†æ]
tags: [å­£èŠ‚æ€§å½¢å˜, æ¨¡å‹æ‹Ÿåˆ, æ•°æ®å¤„ç†, MATLAB]
pin: false
toc: true
comments: true
math: true
---

>  ğŸ“ˆ æœ¬æ–‡è®°å½•äº†ä¸€ç§åŸºäºInSARæ—¶é—´åºåˆ—æ•°æ®çš„åœ°è¡¨å½¢å˜å­£èŠ‚æ€§æ‹Ÿåˆæ–¹æ³•ï¼ŒåŒ…æ‹¬çº¿æ€§é€Ÿç‡ã€å¹´å‘¨æœŸæŒ¯å¹…/ç›¸ä½ã€åŠå¹´å‘¨æœŸæŒ¯å¹…/ç›¸ä½çš„æå–ã€‚é™„å®Œæ•´ MATLAB è„šæœ¬ä»¥ä¾¿å¤ç”¨ã€‚

![æ¨¡å‹æ‹Ÿåˆ](/assets/img/picture/modelfit1.png)

---

## ğŸ“Œ 1. èƒŒæ™¯ç®€ä»‹

åœ¨InSARæ—¶é—´åºåˆ—åˆ†æä¸­ï¼Œåœ°è¡¨å½¢å˜ä¿¡å·é€šå¸¸ä¸ä»…åŒ…å«é•¿æœŸè¶‹åŠ¿ï¼ˆå¦‚åœ°é¢æ²‰é™ï¼‰ï¼Œä¹ŸåŒ…å«æ˜¾è‘—çš„**å­£èŠ‚æ€§å½¢å˜åˆ†é‡**ï¼Œå¦‚å› åœ°ä¸‹æ°´æ³¢åŠ¨å¯¼è‡´çš„å¹´/åŠå¹´å‘¨æœŸä¿¡å·ã€‚

ä¸ºäº†æ›´å‡†ç¡®åœ°æå–è¿™äº›ä¿¡æ¯ï¼Œæˆ‘ä»¬å¸¸é‡‡ç”¨å¦‚ä¸‹æ¨¡å‹è¿›è¡Œæ‹Ÿåˆï¼š

$$
y\left(t\right)=y_0+vt+\sum_{k=1}^{2}\left[a_ksin\left(2\pi kt\right)+b_k\cos{\left(2\pi kt\right)}\right]+\varepsilon(t)
$$

å…¶ä¸­ï¼š
- \\( v \\) ï¼šçº¿æ€§é€Ÿç‡ï¼ˆå•ä½ï¼šmm/yearï¼‰
- \\( y_0 \\) ï¼šæˆªè·
- \\( t \\) ï¼šæ—¶é—´ï¼ˆå•ä½ï¼šåè¿›åˆ¶å¹´ï¼Œä¾‹å¦‚ 2019.5ï¼‰
- \\( a_k, b_k \\) ï¼šä¸‰è§’å‡½æ•°ç³»æ•°ï¼ˆå­£èŠ‚æ€§å½¢å˜ä¿¡å·ï¼‰ï¼Œ\\( k = 1 \\) è¡¨ç¤º**å¹´å‘¨æœŸ**ï¼Œ\\( k = 2 \\) è¡¨ç¤º**åŠå¹´å‘¨æœŸ**
- \\( \varepsilon(t) \\) ï¼šå™ªå£°é¡¹ï¼Œæœä»ç‹¬ç«‹åŒåˆ†å¸ƒï¼ŒæœŸæœ›ä¸º 0

æ¨¡å‹æ‹Ÿåˆåé€šè¿‡è®¡ç®—å¯ä»¥å¾—åˆ°ï¼š

- å¹´/åŠå¹´å‘¨æœŸçš„**æŒ¯å¹…**ï¼š  
  \\( A_k = \sqrt{a_k^2 + b_k^2} \\)  
- å¹´/åŠå¹´å‘¨æœŸçš„**ç›¸ä½**ï¼š  
  \\( \phi_k = \arctan\left( \frac{a_k}{b_k} \right) \\)

---

## 2. ğŸ“Šè„šæœ¬åŠŸèƒ½è¯´æ˜

> ä¸‹é¢æ˜¯ä¸»è¦çš„ MATLAB è„šæœ¬è¯´æ˜ï¼Œé€‚ç”¨äºä¸€ç»„æ ¼å¼ç»Ÿä¸€çš„ GRD ä½ç§»æ—¶é—´åºåˆ—æ•°æ®ï¼Œå¯å»ºç«‹ä¸€ä¸ªmodelæ–‡ä»¶å¤¹ï¼Œæ‰€æœ‰æ“ä½œåœ¨è¯¥æ–‡ä»¶å¤¹è¿›è¡Œã€‚

- ğŸ“„ è¾“å…¥ï¼š
  - å°†æ‰€æœ‰ç´¯ç§¯å½¢å˜æ …æ ¼æ•°æ®`20*mask_ll_referenced.grd`é“¾æ¥è‡³æ“ä½œï¼Œä¾‹å¦‚ï¼š<br>
    `20200914_mask_ll_referenced.grd`<br>
    `20200928_mask_ll_referenced.grd`<br>
    `20200930_mask_ll_referenced.grd`<br>
  - ğŸŒŸğŸŒŸğŸŒŸæ‰€éœ€è„šæœ¬ï¼šæ–‡ä»¶è¾ƒå¤šï¼Œå¯ä¸‹è½½è§£å‹åæ”¾è‡³æ“ä½œç›®å½•ï¼Œæˆ–å­˜æ”¾åœ¨è‡ªå·±çš„è„šæœ¬åº“ä¸­ï¼Œåœ¨matlabä¸­è®¾ç½®æ°¸ä¹…è·¯å¾„ã€‚<br>
  ğŸ“¦ ä¸‹è½½å®Œæ•´ MATLAB å®ç°è„šæœ¬ï¼š
  
    [Seasonal_model.zip](/assets/files/seasonal_model.zip)

- ä¿®æ”¹è„šæœ¬`Seasonal_model.m`ä¸­å‚æ•°ä¿¡æ¯:

  - æ•°æ®å­˜æ”¾ç›®å½•ä¸ç»“æœè¾“å‡ºç›®å½•ï¼š<br>
    `DataFolder='/media/student/model';`<br>
    `OutFolder='/media/student/model';`
    
  - GRDæ–‡ä»¶å°ºå¯¸ä¿¡æ¯ï¼ˆ`gmt grdinfo file.grd`å³å¯æŸ¥çœ‹æ•°æ®ä¿¡æ¯ ï¼‰ï¼š<br>
    `mat_line=2570;` Yè½´çš„è¡Œåˆ—æ•°<br>
    `mat_col=2790;` Xè½´çš„è¡Œåˆ—æ•°<br>
    ğŸŒŸ è¯·æ³¨æ„Xå’ŒYçš„é¡ºåºã€‚

  - æ—¥æœŸæ–‡ä»¶ä¿¡æ¯ï¼š
    `sardate=load('dates.list');`<br>
    æ–‡ä»¶ä¸­æ¯è¡Œä¸€ä¸ªæ—¥æœŸï¼Œæ ¼å¼ä¸º`yyyymmdd`, å¯è¿è¡Œå‘½ä»¤ç”Ÿæˆï¼š
    ```bash
    ls 20*mask_ll_referenced.grd | awk -F_ '{print $1}' > dates.list
    ```
  > è„šæœ¬ä¸­çš„æ ¸å¿ƒæ‹Ÿåˆå‡½æ•°ä¸º `line_ansef`ï¼Œç”¨æˆ·å¯è‡ªå®šä¹‰è°ƒç”¨ã€‚

- è¾“å‡ºæ–‡ä»¶ï¼š<br>
    `linear_velocity.grd`  çº¿æ€§é€Ÿç‡<br>
    `amp_annual.grd`  å¹´å‘¨æœŸæŒ¯å¹…<br>
    `amp_semiannual.grd` åŠå¹´å‘¨æœŸæŒ¯å¹…<br>
    `phase_annual.grd` å¹´å‘¨æœŸç›¸ä½<br>
    `phase_semiannual.grd` åŠå¹´å‘¨æœŸç›¸ä½<br>
    `rms.grd` æ®‹å·®<br>
    ğŸŒŸè¯·æ³¨æ„ï¼Œå¦‚æœéœ€è¦å°†ç›¸ä½æ”¹ä¸ºæœˆåº¦å•ä½ï¼Œéœ€å°†è„šæœ¬å†…å®¹æ”¹ä¸ºå¦‚ä¸‹ï¼š
      `phase_annual(i)=qtan(d,c)*180/pi/30;` <br>
      `phase_semiannual(i)=qtan(f,e)*180/pi/30;`

ğŸ§  æ‰€æœ‰æ•°æ®æœ€ç»ˆæŒ‰è¡Œåˆ—å±•å¼€ï¼Œé€åƒå…ƒè¿›è¡Œæ‹Ÿåˆï¼Œæœ€åå† reshape ä¸ºäºŒç»´å›¾åƒä¿å­˜ã€‚

---

## 3. ğŸ’¡å•ç‚¹çš„æ¨¡å‹æ‹Ÿåˆ

ä¸ºäº†ç ”ç©¶æŸä¸ªç‚¹çš„å­£èŠ‚æ€§å½¢å˜ç‰¹å¾ä¿¡æ¯ï¼Œæˆ‘ä»¬ä»…éœ€ç®€å•çš„å¯¹å•ä¸ªç‚¹çš„æ—¶é—´åºåˆ—æ‹Ÿåˆã€‚

- é¦–å…ˆéœ€è¦ç‚¹çš„å½¢å˜æ—¶é—´åºåˆ—æ–‡ä»¶ï¼Œå‚è€ƒä¹‹å‰çš„[å½¢å˜æ—¶é—´åºåˆ—æå–](/posts/InSAR-timeseries/#10--å½¢å˜æ—¶é—´åºåˆ—æå–)æ–¹æ³•ã€‚

- ä½¿ç”¨è„šæœ¬å‹ç¼©åŒ…ä¸­çš„`One_point_seasonal_model.m`è„šæœ¬ã€‚åœ¨matlabä¸­ä¿®æ”¹æ–‡ä»¶ä¿¡æ¯å³å¯

  `file=load('P1_ts_disp.txt');`

å³å¯åœ¨matlabå·¥ä½œåŒºä¸­å¾—åˆ°æ¨¡å‹å‚æ•°ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†ä¸€ä¸ªç®€å•çš„å›¾åƒè¾“å‡ºï¼š
![æ¨¡å‹æ‹Ÿåˆ](/assets/img/picture/modelfit2.png)

---

å‚è€ƒæ–‡çŒ®ğŸ“š :
- Wei Tang\*, Xiangjun Zhao, Mahdi Motagh, *et al.* (2022). **Land subsidence and rebound in the Taiyuan basin, northern China, in the context of inter-basin water transfer and groundwater management**. *Remote Sensing of Environment*, *269*, 112792. [https://doi.org/10.1016/j.rse.2021.112792](https://doi.org/10.1016/j.rse.2021.112792)
- Wei Tang\*, Xiangjun Zhao, Gang Bi, *et al.* (2023). **Quantifying seasonal ground deformation in Taiyuan basin, China, by Sentinel-1 InSAR time series analysis**. *Journal of Hydrology*, *622*, 129654. [https://doi.org/10.1016/j.jhydrol.2023.129654](https://doi.org/10.1016/j.jhydrol.2023.129654)
  
  






